Arabian Journal of Geosciences (2018) 11:132
https://doi.org/10.1007/s12517-018-3487-5

ORIGINAL PAPER

Determination and prediction of standardized precipitation index (SPI)
using TRMM data in arid ecosystems
Amr Mossad 1,2

&

A. A. Alazba 1,3

Received: 1 November 2016 / Accepted: 15 March 2018
# Saudi Society for Geosciences 2018

Abstract
Drought over a period threatens the water resources, agriculture, and socioeconomic activities. Therefore, it is crucial for decision
makers to have a realistic anticipation of drought events to mitigate its impacts. Hence, this research aims at using the standardized precipitation index (SPI) to predict drought through time series analysis techniques. These adopted techniques are
autoregressive integrating moving average (ARIMA) and feed-forward backpropagation neural network (FBNN) with different
activation functions (sigmoid, bipolar sigmoid, and hyperbolic tangent). After that, the adequacy of these two techniques in
predicting the drought conditions has been examined under arid ecosystems. The monthly precipitation data used in calculating
the SPI time series (SPI 3, 6, 12, and 24 timescales) have been obtained from the tropical rainfall measuring mission (TRMM).
The prediction of SPI was carried out and compared over six lead times from 1 to 6 using the model performance statistics
(coefficient of correlation (R), mean absolute error (MAE), and root mean square error (RMSE)). The overall results prove an excellent
performance of both predicting models for anticipating the drought conditions concerning model accuracy measures. Despite this, the
FBNN models remain somewhat better than ARIMA models with R  0.7865, MAE  1.0637, and RMSE  1.2466. Additionally, the
FBNN based on hyperbolic tangent activation function demonstrated the best similarity between actual and predicted for SPI 24 by
98.44%. Eventually, all the activation function of FBNN models has good results respecting the SPI prediction with a small
degree of variation among timescales. Therefore, any of these activation functions can be used equally even if the sigmoid and
bipolar sigmoid functions are manifesting less adjusted R2 and higher errors (MAE and RMSE). In conclusion, the FBNN can be
considered a promising technique for predicting the SPI as a drought monitoring index under arid ecosystems.
Keywords Artificial intelligence . SPI . TRMM data . Water resources

Introduction
Drought is one of the most extremely complex natural disasters that have a direct influence on water resources. Therefore,
it adversely affects the quality of life and economic conditions.

* Amr Mossad
aabdelbary@ksu.edu.sa; amr_abdelbari@agr.asu.edu.eg
A. A. Alazba
alazba@ksu.edu.sa
1

Agricultural Engineering Department, King Saud University,
Riyadh, Kingdom of Saudi Arabia

2

Agricultural Engineering Department, Ain Shams University,
Cairo, Egypt

3

Alamoudi Water Research Chair, King Saud University,
Riyadh, Kingdom of Saudi Arabia

In the context of the current climate change, the existence of
drought could be more disruptive (Nam et al. 2015). However,
there is no universal definition of drought (Oh et al. 2015).
However, many scholars defined it as an extended period with
inadequate water supply (Qureshi and Akhtar 2004; Raudkivi
2013; Strelcov et al. 2008). In other words, the drought is a
deficiency of precipitation from its regular rates that can affect
the required amount of water for ecosystems (Estrela and
Vargas 2012). The occurrence of drought is not limited to
the arid and hyper-arid areas and can be observed in many
other ecosystems. Accordingly, many parts of the globe have
been attacked by drought. This reason encouraged scientists to
study the drought and develop plentiful indices for describing
the drought condition. Most of these indices are discussed and
mentioned in Heim (2002) and Smakhtin and Hughes (2004).
Among the developed indices, the standardized precipitation
index (SPI) is one of the widely used and recently applied in
different drought studies such as: Bowden et al. (2016),
Huang et al. (2015), Ionita et al. (2016), Musuuza et al.

132

Page 2 of 16

(2016) and Olivares et al. (2016). This attention in using the
SPI is due to its calculation simplicity and flexibility at different timescales because it is only based on precipitation data
over time (Mahfouz et al. 2016).
The proper drought management depends substantially on
the timely receipt of information about the onset of drought
(Farokhnia et al. 2011). The beginning of a drought can be
captured from its appropriate forecasting that will improve the
early warning systems (Hosseini-Moghari and Araghinejad
2015; Morid et al. 2007). Several attempts have been applied
to forecast the drought (Huang et al. 2016; Le et al. 2016;
Lohani et al. 1998; Ren et al. 2016; Rezaeianzadeh et al.
2017). The traditional approach of drought forecasting is
based mainly on the autoregressive integrated moving average
(ARIMA). The method of ARIMA is assuming that time series is formed from a linear process. In fact, this is often contrary to the real world where the time series is commonly
nonlinear (Mishra and Desai 2006; Zhang 2003). However,
it is indispensable using an alternative approach that overcomes the previous problem of ARIMA models. The
ARIMA models have been applied widely in different studies
related to drought forecasting. Tian et al. (2016) have forecasted the drought with vegetation temperature condition index
using the ARIMA models.
Recently, one of the broadly known forecasting approaches
is the artificial neural networks (ANNs). The ANNs models
have demonstrated satisfactory results in sectors of water
resources and drought monitoring. For example, Shafaei and
Kisi (2016) have used the wavelet-artificial neural networks to
predict the daily river flow. Traore et al. (2016) attempted to
deploy the ANN for forecasting short-term reference evapotranspiration (ETo) using public weather forecast-restricted
messages. Maca and Pech (2016) predicted standardized precipitation evapotranspiration index (SPEI) and SPI by using
the integrated ANNs. Valipour (2016) applied the ANNs for
precipitation analysis to detect drought and wet year alarms.
Zakhrouf et al. (2016) modeled a catchment flow using the
neuro-wavelet (WNN) and neuro-fuzzy (ANFIS).
The lack of historical precipitation data, as a result of the
scattered distribution of precipitation gauges, can lead to significant errors in estimating the SPIs statistical parameters.
Therefore, the tropical rainfall measuring mission (TRMM)
is a potent and advantageous tool for precipitation monitoring
that can solve the previous problem in different regions. The
TRMM is a joint mission between the National Aeronautics
and Space Administration (NASA) and the Japan Aerospace
Exploratory Agency (JAXA). This satellite mission is
launched in November 1997 with a primary goal of studying
and monitoring the tropical rainfall (Sassa et al. 2014). The
TRMM can furnish the precipitation data for large-scale areas
with high temporal (about 3 h) and spatial (0.25  0.25) resolutions (Brown 2008). Accordingly, the TRMM data were
extensively validated and used for many hydrological studies

Arab J Geosci (2018) 11:132

in different locations over the world. For instance, a study
conducted in West Africa shows that the TRMM data has a
good agreement with the in situ data in monthly and seasonal
timescales (Adeyewa and Nakamura 2003; Dinku et al. 2007;
Nicholson et al. 2003). Rhee and Carbone (2011) stated that
the TRMM data could not surpass the spatially interpolated
daily precipitation data. Meanwhile, in some regions with a
shortage of in situ records, the TRMM data work better than
the spatially interpolated values for drought monitoring.
Practically, the TRMM data have been used in different hydrologic studies (Collischonn et al. 2008; Karakoc and Patil
2016; Li et al. 2012; Meng et al. 2014; Simons et al. 2016; Su
et al. 2008; Tang et al. 2016). Meanwhile, it was applied to
monitor and determine the drought conditions based on the
SPI over different climatic ecosystems (Li et al. 2013;
Naumann et al. 2012; Tao et al. 2016).
The present work aims to determine the SPI at four timescales (SPI 3, 6, 12, and 24) using the data obtained from
TRMM as a cost-effective precipitation data source. In addition, studying the suitability of employing the Autoregressive
Integrated Moving Average (ARIMA) and Feed-Forward
Backpropagation Neural Network (FBNN) models to predict
the SPI in the future.

Material and methods
Research extent and data processing
The study area is located in the Kingdom of Saudi Arabia
(KSA), a country situated in the far southwest corner of
Asia. The coordinates of the KSA lies between latitudes 16
22 46 and 32 14 00 N and longitudes 34 29 30 and 55
40 00 E. As shown in Fig. 1, the study covers 13 provinces
with a total approximate area of 1,950,000 km2. The climate
of KSA is characterized by hot summers, cold winters, and
low precipitation rates except the southwest areas. The monthly precipitation data used for this study were obtained from the
TRMM that are deployed by NASA. The TRMM data consists of different spatiotemporal resolutions products. There
are three temporal resolutions products of three-hourly
(3B42), daily (3B42 derived), and monthly (3B43). All these
three products are having a spatial resolution of 0.25  0.25
and extending from latitude 50 S to 50 N. In this study, the
monthly TRMM (3B43) datasets have been used from 2000 to
2014. These datasets were gridded to 28 points as shown in
Fig. 1 and then used to develop the SPI time series of each
point. The geostatistical approach applied to interpolate the
data is the inverse distance weighting (IDW) technique, which
has been widely adopted for the estimation of spatially distributed precipitation and SPI.
Drought quantification and prediction remain one of the
significant challenges and crucial task for water resources

Arab J Geosci (2018) 11:132

Page 3 of 16 132

Fig. 1 Schematic map of precipitation points locations used in the study

decision makers. Thus, two different types of time series prediction models (ARIMA and FBNN) are compared in this
work. The available SPI time series data are divided into
two groups, the SPI time series data from 2000 to 2011 was
dedicated to developing the prediction the models.
Meanwhile, the rest of the time series data from 2012 to
2013 was directed to check the prediction accuracy. The SPI
of 3, 6, 12, and 24 timescales were predicted over six lead
times by using the best selected ARIMA model and FBNN
models. Additionally, these FBNN models are based on three
activations functions (sigmoid, bipolar sigmoid, and hyperbolic tangent).

SPI time series development

The relevant PDF is elected according to the L-moment ratio
diagrams. Consequently, a continuous probability distribution
of two-parameter (gamma distribution) is applied. The gamma
distribution is defined by its PDF as:
gx  1=  1 e= ; for  > 0
where  and  are factors for shape and scale respectively (greater than 0), and they have been approximated to maximum likelihood according to Thom (1958),  is the amount of precipitation, and () is the gamma distribution function.
By integrating the PDF for  and attach  and  parameters, the cumulative probability distribution function, G(x), for
an observed precipitation event for specific months and timescale will be obtained as:


After creating the monthly precipitation time series, an algorithm
was used to calculate the SPI and create a new time series of it.
The SPI calculation procedure is based on the methodology proposed by (McKee et al. 1993). The first step in performing this
method is to fit the probability density function (PDF) to the
frequency distribution of total precipitation amount for a specific
area. Therefore, the PDF characterizes the distribution of precipitation data series at different timescales. Four SPI timescales of
3, 6, 12, and 24 are selected for SPI development. These patterns
are performed independently for each precipitation time series.

^



^

^^ 
^  0 ^1 e=^
G  0 gd  1=
^ = t will reduce the above equation to incomPutting =
plete gamma function. Since the gamma distribution function
is undefined at  = 0, the precipitation distribution may be
equal to nil. Thus, the cumulative probability, H(), with the
probability of zero distribution of precipitation (q) will become as follows:
H   q  1qG

132

Arab J Geosci (2018) 11:132

Page 4 of 16

Finally, an equiprobability transformation is made for the
H() to obtain the value of SPI according to (Ayuso et al.
2015). The SPI values were compared with the reference classes
in Table 1. The previously described methodology of computation the SPI has been applied recently in many research such as
(Asadi Zarch et al. 2015; Mahfouz et al. 2016; Mishra and Desai
2005, 2006).

SPI time series prediction models
Coping with water scarcity needs a comprehensive water
management that bases mainly on the extreme drought event
prediction. Usually, the drought prediction is the estimation of
drought conditions. Numerous approaches and models have
been applied to predict it. The following section briefly addresses the basic concepts of the predicting methods applied to
the SPI foreseeing in this study.

Fig. 2 Model development procedure (adopted form Box and Jenkins
1976)

Artificial neural network modeling
Stochastic modeling
The stochastic or ARIMA models have been used in this
study. Initially, the development of ARIMA models uses an
iterative three-step modeling approach that proposed by Box
and Jenkins (1976) (Fig. 2). The first step starts with model
identification in which checking stationarity and seasonality
of the time series (seasonal differencing if required).
Additionally, by using the plots of the autocorrelation function
(ACF) and partial autocorrelation function (PACF), the decision of which autoregressive or moving average should be
considered in the model structure. The second step used to
find the coefficients for the best fitted ARIMA model through
maximum likelihood estimation as explained by Brockwell
and Davis (2002). The last step is the diagnostic checking test
that assures the reliability and acceptability of the developed
ARIMA models. This test was performed according to the
graphical technique method that can be summarized as follows: the ACF and PACF of residuals, histogram of residuals,
and normal probability of residuals.

Table 1 Dryness/
wetness classification
based on SPI values

SPI value

SPI classes

SPEI   2
 2 < SPI   1.5
 1.5 < SPI   1
 1 < SPI  1
1 < SPI  1.5
1.5 < SPI  2
SPI  2

Extremely dry
Severely dry
Moderately dry
Near normal
Moderately wet
Severely wet
Extremely wet

Recently, the Artificial neural networks (ANN) have made
important advancement that proves their effectiveness in addressing many hydrologic issues. The ANNs show a strong
ability to approximate the multivariate functions which are
called universal approximation. Therefore, the ANNs can be
adapted to a wide range of predicting time series data with a
satisfactory performance (Khashei and Bijari 2011). In this
research, the FBNN topology with the backpropagation learning algorithm was applied to predict the SPI. The created
FBNN models consist of three layers. These are an input layer,
one or more hidden layers, and an output layer. Mainly, the
advantage of the backpropagation algorithm is that to minimize the error function in weight space based on the gradient
descent method. This error function can be found as follows:
E

1 1
 y ^
^y 
k k1 k k

In which yk and ^yk are the observed and predicted values of
output neuron, k. Meanwhile, the gradient descent method is
selecting the connection weights based on the gradient error
(wij), which is expressed as:
 wij   

E
wij

where the wijis the connective weight,  is the learning rate,
E
and w
is based on the output value of sublayer An1
and the
i
ij
error signal nj . They can be adjusted mathematically during
training as:
wij t  1  wij t    wij t  1   wij t 

Arab J Geosci (2018) 11:132
Table 2 Main statistical features
of precipitation data series with
coordinates of gridded points
used in the study

Page 5 of 16 132

Latitude
degrees

Longitude
degrees

Time series

Point

Mean
(mm)

Max
(mm)

Min
(mm)

SD

1
2
3
4
5
6
7
8
9
10

18.75
18.75
18.75
18.75
21.25
21.25
21.25
21.25
21.25
21.25

41.25
43.75
46.25
48.75
41.25
43.75
46.25
48.75
51.25
53.75

20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014

0.36
0.28
0.18
0.16
0.34
0.24
0.19
0.17
0.14
0.15

3.37
0.28
0.18
0.16
0.34
0.24
0.19
0.17
0.14
0.15

0.002
0.000
0.000
0.000
0.003
0.000
0.000
0.000
0.000
0.000

11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28

21.25
23.75
23.75
23.75
23.75
23.75
26.25
26.25
26.25
26.25
26.25
28.75
28.75
28.75
28.75
28.75
31.25
31.25

53.75
41.25
43.75
46.25
48.75
51.25
38.75
41.25
43.75
46.25
48.75
36.25
38.75
41.25
43.75
46.25
38.75
41.25

20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014
20002014

0.15
0.26
0.26
0.26
0.26
0.26
0.14
0.20
0.27
0.34
0.37
0.11
0.17
0.21
0.24
0.34
0.19
0.23

0.15
0.26
0.27
0.27
0.27
0.26
0.14
0.20
0.27
0.34
0.37
0.12
0.17
0.21
0.24
0.33
0.19
0.22

0.000
0.000
0.276
0.285
0.281
0.273
0.142
0.205
0.280
0.353
0.381
0.117
0.168
0.207
0.238
0.332
0.189
0.222

S t  

The activation functions determine the relationship between inputs and outputs of the network. However, the activation functions of sigmoid, bipolar sigmoid, and hyperbolic
tangent are used. The mathematical equations of these activation functions are as follows:

Prediction accuracy measures



Bipolar sigmoid
2
1
1  et

MAE 

Hyperbolic

0.39
0.54
0.78
0.69
0.49
0.65
0.99
1.12
0.87
0.84

0.47
0.25
0.20
0.25
0.70
0.05
0.20
0.01
0.83
0.49

0.85
0.03
0.76
0.52
0.02
0.26
0.63
0.56
0.14
0.18

0.22
0.40
0.28
0.29
0.29
0.28
0.14
0.20
0.28
0.35
0.38
0.12
0.17
0.20
0.24
0.33
0.18
0.22

0.40
0.02
0.28
0.29
0.29
0.28
0.14
0.20
0.28
0.36
0.38
0.12
0.16
0.20
0.24
0.34
0.18
0.21

0.95
0.06
0.27
0.29
0.30
0.29
0.14
0.20
0.28
0.35
0.37
0.12
0.16
0.19
0.23
0.34
0.17
0.20

The overall performance of each developed model is criticized
by comparing the predicted SPI time series with the actual SPI
time series. This comparison has been carried out through two
commonly accuracy measures of fits that are based on the
prediction errors (mean absolute error (MAE) and root mean
square error (RMSE)) and can be expressed as the following:
RMSE 

S t  

Kurtosis

1e2t
1  e2t

E
 nj An1
i
wij

Sigmoid
1
S t  
1  et

Skewness

1 n
 y ^
^y 2
n i1 i i

 12

1 n
 jy ^
y^j
n i1 i i

where n is the number of prediction events, yi the actual SPI
and ^yi the predicted SPI.

132

Arab J Geosci (2018) 11:132

Page 6 of 16

Fig. 3 Spatial distribution of precipitation rate (mm/h) during the period of 20002014 for the study area

Similarity of prediction models
A similarity comparison between the actual and predicted data
of SPI has been conducted through the hierarchical procedure.
It is, therefore, possible to know which set of actual and predicted data are similar of correlated to each other.
Accordingly, the similarity between selected models is considered as a tool for choosing the related models. It was calculated by the following equation:

100 1d yi^^yi
Similarity of yi and ^yi 
d max
where d yi ^yi is is the distance between the actual and predicted
SPI and dmax is the maximum original distance.

From this table, it can be noted that there are no significant
differences in the annual data averages of precipitations. At
the same time, a spatial interpolation of the precipitation rates
over the KSA was depicted in Fig. 3 using data gathered from
TRMM (3B43). Based on this analysis, the KSA had meager
precipitation rates over land from 2000 to 2014. It is approximately ranging between 0.0002 and 0.022 mm/h. Only a few
parts of the southwest have precipitation rates (ranges between
0.033 and 0.34 mm/h) slightly higher than the rest of the study
area. The overall time series mean and maximum of the precipitation rate with the standard deviation is given in Fig. 4.
Notably, there is a certain presence of general temporal trend
for the mean precipitation rate. However, there is an exception
of few years with extreme values of maximum precipitation
rates such as 2006.

Spatial and temporal extent of SPI

Results and discussion
Precipitation analysis of satellite observations
Initially, a descriptive analysis of the gridded precipitation
data series, as the most drought-relevant parameter, was conducted for the study area. The statistical features of precipitation data series for each gridded point are shown Table 2.

In this work, the SPI time series of each grid point was interpolated to obtain the drought maps for all the study area.
These maps (Fig. 5) show the temporal and spatial extent of
wetness and dryness areas in the KSA at SPI 3, 6, 12, and 24
timescales (covering the period of 20002014). As noted from
this figure, all the SPI timescales oscillate between the near
normal and moderately wet by more than 70%. Only a few

Arab J Geosci (2018) 11:132

Page 7 of 16 132

Fig. 4 Time series of the mean
precipitation rate, maximum
precipitation rate, and standard
deviation over the study area

months with the value of extremely dry condition appear in
the SPI 24 by 2.2% in 2009.
In the following section, only the short-term timescale
of SPI (SPI 3) is presented in Fig. 6 as an illustrative
example. These maps demonstrate a particular homogeneity condition in the spatial variability of drought based on

the SPI 3. As well as it illustrates that the general drought
condition occurring is a near normal during the study
period with the exception of moderately wet conditions
in 2004 and 2005. This result highlights to an apparent
decrease in the precipitation deficit with various degrees
of drought conditions over the study area.

Fig. 5 A monthly SPI time series for different time scales based on the average precipitation over the KSA during 20002014

132

Page 8 of 16

Arab J Geosci (2018) 11:132

Fig. 6 Spatial distribution of short-term standardized precipitation index (SPI 3) based on TRMM data over Saudi Arabia during 20002014

Arab J Geosci (2018) 11:132
Table 3
SPI

Page 9 of 16 132

Model performance statistics of selected ARIMA models for SPI 3, 6, 12, and 24 timescale over six lead times
Stochastic model

3

ARIMA(0,0,2)(0,1,0)

6

ARIMA(0,0,3)(0,1,0)

12

ARIMA(0,0,2)(1,1,0)

24

ARIMA(0,0,2)(2,1,0)

Model fit measures

R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE

Lead time
1

2

3

4

5

6

0.6882
0.5231
0.6550
0.7167
0.5190
0.6073
0.7573
0.5161
0.5942
0.8340
0.4960
0.5673

0.6361
0.7152
0.9442
0.7030
0.7132
0.9242
0.7562
0.5800
0.7600
0.7810
0.5083
0.7532

0.6160
0.9801
1.1861
0.6970
0.9491
1.1771
0.7501
0.9431
1.1563
0.7710
0.8405
1.0870

0.6011
1.0631
1.2771
0.6614
1.0433
1.2710
0.7381
1.0260
1.2371
0.7691
1.0160
1.1910

0.5901
1.1552
1.4012
0.6312
1.1471
1.3912
0.7371
1.1360
1.3650
0.7680
1.1240
1.3600

0.5722
1.3660
1.6243
0.6161
1.3271
1.5733
0.7312
1.2761
1.5171
0.7600
1.2160
1.4060

R, coefficient of correlation; MAE, mean absolute error; RMSE, root mean square error

Fig. 7 Comparison between actual and forecasted data for 324 SPI ARIMA models over different lead times

132

Arab J Geosci (2018) 11:132

Page 10 of 16

Table 4 Model performance
statistics of FBNN based on
different activation functions
(sigmoid, bipolar sigmoid, and
hyperbolic tangent) for SPI 3, 6,
12, and 24 timescales over six
lead times

SPI

3

Activation
function

Sigmoid

Bipolar sigmoid

Hyperbolic
tangent
6

Sigmoid

Bipolar sigmoid

Hyperbolic
tangent
12

Sigmoid

Bipolar sigmoid

Hyperbolic
tangent
24

Sigmoid

Bipolar sigmoid

Hyperbolic
tangent

Model fit
measures

Lead time
1

2

3

4

5

6

R

0.8595

0.8497

0.8419

0.8256

0.8014

0.7865

MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE

0.4290
0.5500
0.8894
0.3290
0.4561
0.8991
0.2841
0.3718
0.9047
0.2590
0.3360
0.9191
0.2533
0.3341
0.9228
0.2513
0.3338
0.9244
0.2471

0.4810
0.6930
0.8821
0.4810
0.6256
0.8884
0.4123
0.4857
0.8967
0.4057
0.4841
0.9117
0.3972
0.4821
0.9145
0.3930
0.4797
0.9173
0.2856

0.8310
1.0130
0.8751
0.7420
0.8674
0.8791
0.6730
0.7445
0.8870
0.6690
0.7426
0.8915
0.6475
0.7415
0.9070
0.6362
0.7411
0.9094
0.2864

0.8613
1.0484
0.8616
0.7660
0.9023
0.8665
0.6940
0.7653
0.8792
0.6902
0.7641
0.8830
0.6685
0.7638
0.8934
0.6656
0.7587
0.8963
0.2886

1.0127
1.1922
0.8399
0.9173
1.0378
0.8429
0.8443
0.9160
0.8574
0.8399
0.9143
0.8716
0.8395
0.9136
0.8747
0.8253
0.9068
0.8790
0.3060

1.0637
1.2466
0.8255
0.9704
1.0931
0.8264
0.8997
0.9654
0.8429
0.8955
0.9646
0.8564
0.8790
0.9627
0.8607
0.8756
0.9523
0.8642
0.3135

RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE
R
MAE
RMSE

0.3314
0.9259
0.2402
0.3182
0.9277
0.2390
0.3170
0.9301
0.2344
0.3167
0.9346
0.2238
0.3142
0.9421
0.2202
0.3107

0.3726
0.9185
0.2561
0.3332
0.9204
0.2430
0.3322
0.9217
0.2398
0.3318
0.9217
0.2251
0.3149
0.9363
0.2203
0.3125

0.3728
0.9128
0.2841
0.3592
0.9135
0.2459
0.3562
0.9149
0.2428
0.3551
0.9167
0.2257
0.3152
0.9168
0.2206
0.3126

0.3742
0.9006
0.2863
0.3618
0.9010
0.2472
0.3602
0.9021
0.2443
0.3564
0.9041
0.2263
0.3159
0.9043
0.2209
0.3139

0.3792
0.8792
0.2918
0.3765
0.8795
0.2498
0.3728
0.8804
0.2451
0.3713
0.8826
0.2265
0.3161
0.8827
0.2218
0.3156

0.3812
0.8648
0.2938
0.3807
0.8653
0.2569
0.3805
0.8658
0.2498
0.3801
0.8680
0.2279
0.3162
0.8682
0.2226
0.3159

R, coefficient of correlation; MAE, mean absolute error; RMSE, root mean square error

Time series prediction
Four best ARIMA model combination structures are selected according to ACF and PACF for each timescale (SPI 3,
6, 12, and 24). These combinations with their model fit
measures are presented in Table 3. The chosen ARIMA
model structures for predicting SPI 3, 6, 12, and 24 timescales are ARIMA(0,0,2)(0,1,0), ARIMA(0,0,3)(0,1,0),
ARIMA(0,0,2)(1,1,0), and ARIMA(0,0,2)(2,1,0),

respectively. From these results, it is noted that there is
an existence of two basic trends in these selected ARIMA
models regarding the ability to predict SPI. Firstly, the
accuracy of drought forecasting downturns by increasing
the lead time number in all selected ARIMA models.
Secondly, the forecasting accuracy is highly related to
SPI timescale. Hence, the SPI 24 is more accurate than
SPI 3 in forecasting. This result is similar to the outcome
obtained by Mishra and Desai (2006).

Arab J Geosci (2018) 11:132

Page 11 of 16 132

Fig. 8 A comparison between different activation functions over 16 lead-time for SPI 24 time series

The comparison of actual and predicted data for the SPI
timescales at different lead times is displayed in Fig. 7. It can

be observed that the fluctuations in the time series decrease
with increasing the SPI timescale. Additionally, the predicted

132

Arab J Geosci (2018) 11:132

Page 12 of 16

Table 5 Statistical analysis of FBNN models based on different activation functions (sigmoid, bipolar sigmoid, and hyperbolic tangent) for SPI 3, 6,
12, and 24 timescale at one lead time
SPI time series

Activation function

Mean
Actual

3

6

12

24

Sigmoid
Bipolar sigmoid
Hyperbolic tangent
Sigmoid
Bipolar sigmoid
Hyperbolic tangent
Sigmoid
Bipolar sigmoid
Hyperbolic tangent
Sigmoid
Bipolar sigmoid
Hyperbolic tangent

Variance
Predicted

Actual

F test
Predicted

Calculated

Z test
Critical one-tail

Calculated

Critical two-tail

0.394

0.376

0.214

0.118

1.815

2.014

0.151

1.960

0.394
0.394
0.003
0.003
0.003
 0.076
 0.076
 0.076
 0.367
 0.367
 0.367

0.272
0.239
 0.030
 0.031
 0.093
 0.052
 0.039
 0.051
 0.332
 0.306
 0.325

0.214
0.214
0.220
0.220
0.220
0.177
0.177
0.177
0.394
0.394
0.394

0.195
0.212
0.161
0.292
0.170
0.199
0.225
0.222
0.368
0.336
0.259

1.098
1.007
1.366
1.326
1.298
1.127
1.274
1.257
1.070
1.173
1.522

2.014
2.014
2.014
2.014
2.014
2.014
2.014
2.014
2.014
2.014
2.014

0.932
1.159
0.259
0.235
0.753
0.197
0.286
0.194
0.195
0.199
0.172

1.960
1.960
1.960
1.960
1.960
1.960
1.960
1.960
1.960
1.960
1.960

values become closer to actual data over different lead times.
Therefore, the fewer fluctuations in the SPI time series gives
more forecasting accuracy of the ARIMA models.
In this work, the FBNN models based on the activation
functions (sigmoid, bipolar sigmoid, and hyperbolic tangent)
developed for the SPI forecasting is consisting of 12 input
layer neurons, 12 hidden layer neurons, and 1 output layer
neuron. The FBNN model performance statistics of these
three activation functions (sigmoid, bipolar sigmoid, and hyperbolic tangent) are presented in Table 4. The results of the
prediction accuracy for FBNN models show that as the lead
time of the SPI timescale is increased, the prediction measure
accuracy deteriorates for all activation functions. As well as
among the three activation functions, the hyperbolic tangent
shows the best results in terms of R, MAE, and RMSE.
Overall, there is no significant difference among the studied
activation functions within the same SPI timescale.
Nevertheless, the SPI 24 performs better than the other SPI
timescales in predicting the time series, where the model fit
measures have registered the highest R value with lowest
MAE and RMSE values. Therefore, the hyperbolic tangent
FBNN of SPI 24 has the highest R of 0.942 with lowest
MAE and RMSE of 0.2202 and 0.3107, respectively.
Figure 8 illustrates a comparison between the studied activation functions that confirms the results mentioned above.
By comparing the results of ARIMA and FBNN models for
predicting the SPI time series, it can be mentioned that both
models are performing well at different lead times, mainly for
the long-term SPI (SPI 12 and 24). The good performance
reason for SPI 12 and 24 may be due to the low seasonal
fluctuating in the time series, which effectively diminishes
the noise (Mishra et al. 2007). Meanwhile, it can be summarized that the FBNN models can be a useful tool for predicting

droughts at different lead times from 1 to 6 in arid ecosystems.
In other words, the FBNN (as one of the machine learning
technologies) perform more efficiently than the traditional
ARIMA models in anticipating SPI 3, 6, 12, and SPI 24 at
the lead times mentioned above. Similar results have been
achieved by(Belayneh et al. (2014)). The real reason behind
this preference is due to the ability of FBNN in modeling the
nonlinear components of SPI time series data. In both ARIMA
and FBNN models, the prediction performance is decreased
by increasing the time series lead time. Therefore, the R is
noticeably augmented, while the MAE and RMSE are diminished by increasing the forecast lead time.

Prediction of selected FBNN model
Because the number of models formed is enormous, only the
best models have been taken to present the comparison results
of the actual and predicted SPI data. However, the prediction
was conducted for FBNN models at SPI 3, 6, 12, and 24
timescales and one lead time. The FBNN models were developed by taking into account the three activation functions used
in the study. Table 5 shows the basic statistics of the actual and
predicted SPI data as well as the F and Z tests for considered
FBNN models. Notably, the critical one-tailed F values (
2.014 at a significance level of 5%) for all models are higher
than the calculated F values. Likewise, the critical two-tailed Z
values ( 1.960 at a significance level of 5%) for all models
are also greater than the calculated Z values. Thus, there is no
difference between the mean of actual and predicted SPI (accept the null hypothesis).
Figure 9 shows the linear relationship between the actual
SPI values versus predicted SPI values obtained from the selected FBNN based on sigmoid, bipolar sigmoid, and

Arab J Geosci (2018) 11:132

Page 13 of 16 132

Fig. 9 Scatterplot of actual versus predicted standardized precipitation index (SPI) using the FBNN model for SPI 3, 6, 12, and 24 time series at lead time
1. Bars on the right are the maximum adjusted R2 for each activation function based on the best fitting model of actual versus predicted SPI

hyperbolic tangent for SPI 3, 6, 12, and 24 time series at the
one lead time. This relationship shows a marginal difference
between models in the study. Regarding predictive ability, the
selected models were compared with the maximum adjusted
coefficient of determination R2 for each activation function. It
was observed that all models have a high adjusted R2 (more
than 80%) except the sigmoid and bipolar sigmoid of the SPI 3
with 52.71 and 79.67%, respectively. Meanwhile, the best
predictive ability model was the hyperbolic tangent activation

function with adjusted R2 of 91.13, 90.71, 89.21, and 81.31%
for SPI 24, 12, 6, and 3, respectively. These results are confirmed by the model as mentioned earlier fit measures R,
MAE, and RMSE. Thus, the SPI with higher timescale has
predictive ability better than the lower. This finding has been
recently demonstrated by many researchers on similar time
series, e.g., standardized precipitation evapotranspiration index (SPEI) prediction using artificial intelligence models (Soh
et al. 2018).

132

Page 14 of 16

Arab J Geosci (2018) 11:132

Fig. 10 Complete linkage
between actual and predicted
standardized precipitation index
(SPI) values of sigmoid, bipolar
sigmoid, and hyperbolic
activation functions at SPI 3, 6,
12, and 24 timescales and 1 lead
time

Figure 10 depicts the similarity among the selected FBNN
models with different activation functions in predicting the
SPI of the standard rainfall index. This dendrogram illustrates
how the selected FBNN models are highly correlated and they
have Similarity of yi and ^yi Close to 100%. This dendrogram
is divided into 4 SPI timescales (different colors). The cutting
dendrogram was at a similarity level of approximately 86.42%
in the SPI 3 timescale. The best similarity between actual and
predicted was noted in the FBNN model of SPI 24 with hyperbolic tangent activation function by 98.44%. In the same
SPI timescale, the order of models based on their similarities
with actual SPI data was hyperbolic tangent, bipolar sigmoid,
and sigmoid functions. As we move higher in the dendrogram,
the FBNN activation functions are getting bigger, and the
similarity between them is decreased. However, it is seen from
Fig. 10 that there is the same general behavior among the same
activation function.
As is evident from the above, the FBNN models
have good results concerning prediction as well as the
activation functions slightly vary in the SPI timescale.
Therefore, any of these activation functions can be used
equally even if the sigmoid and bipolar sigmoid functions are manifesting less adjusted R2 and higher errors
(MAE and RMSE).

Conclusions
Notably, one of the major problematic issues in water
resources management is quantifying and anticipating
the drought events, especially with the lack of in situ
weather data. Therefore, the current research attempts to

use the TRMM data, as a good source of precipitation
data, in calculating and predicting the SPI. Therefore,
the SPI time series was estimated at various timescales
(SPI 3, 6, 12, and 24) over the KSA during 20002014.
Subsequently, the created SPI time series were used in
developing the ARIMA and FBNN models. Hence, these
two models were evaluated and applied for drought forecasting using the SPI under arid ecosystems. The SPI 3, 6,
12, and 24 timescales were modeled and predicted over
one to six lead times using the approaches mentioned
above. The developed models were evaluated quantitatively using the R, MAE, and RMSE. The predicting results of these models are demonstrating two main trends
concerning the SPI predicting performance measures.
Firstly, the prediction accuracy is decreased by
diminishing the lead times. Secondly, the prediction is
improved by increasing the SPI timescale (i.e., the worst
forecasting models were in the short-term timescale (SPI
3), while the best models were in the long-term timescale). As well as it can be drawn from the comparison
between the ARIMA and FBNN models: (1) The FBNN
models with different activations functions perform better
than ARIMA models with higher values of R and lower
values of errors (MAE and RMSE). (2) The FBNN that
based on hyperbolic tangent activation function is the best
model for predicting the SPI under KSA. Based on the
similarity of the FBNN activation functions, there are no
evident differences between FBNN models developed by
these activation functions. Thus, they can be adopted for
predicting the SPI although some models showed a slightly greater linking over others concerning similarity and
errors.

Arab J Geosci (2018) 11:132
Acknowledgements Analyses and visualizations used in this paper were
produced with the Giovanni online data system, developed and maintained by the NASA GES DISC.
Funding information The Project was Financially Supported by King
Saud University, Vice Deanship of Research Chairs.

References
Adeyewa ZD, Nakamura K (2003) Validation of TRMM radar rainfall data
over major climatic regions in Africa. J Appl Meteorol 42:331347
Asadi Zarch MA, Sivakumar B, Sharma A (2015) Droughts in a warming
climate: a global assessment of standardized precipitation index (SPI)
and reconnaissance drought index (RDI). J Hydrol 526:183195
Ayuso LJ, Ayuso-Ruiz P, Garca-Marn PA, Estvez J, Taguas VE (2015)
Local analysis of the characteristics and frequency of extreme
droughts in Mlaga using the SPI (standardized precipitation index).
In: Ayuso Muoz LJ, Yage Blanco LJ, Capuz-Rizo FS (eds) Project
management and engineering: selected papers from the 17th international AEIPRO Congress held in Logroo, Spain, in 2013.
Springer International Publishing, Cham, pp 167179
Belayneh A, Adamowski J, Khalil B, Ozga-Zielinski B (2014) Long-term
SPI drought forecasting in the Awash River Basin in Ethiopia using
wavelet neural network and wavelet support vector regression
models. J Hydrol 508:418429
Bowden JH, Talgo KD, Spero TL, Nolte CG (2016) Assessing the added
value of dynamical downscaling using the standardized precipitation
index. Adv Meteorol 2016:14
Box GEP, Jenkins GM (1976) Time series analysis. Forecasting and control. Revised ed. Holden-Day, San Francisco, p 575
Brockwell PJ, Davis RA (2002) Introduction to time series and forecasting, 2nd edn. Springer, New York, p 437
Brown ME (2008) Famine early warning systems and remote sensing
data. Springer, Berlin, p 78
Collischonn B, Collischonn W, Tucci CEM (2008) Daily hydrological
modeling in the Amazon basin using TRMM rainfall estimates. J
Hydrol 360:207216
Dinku T, Ceccato P, Grover-Kopec E, Lemma M, Connor SJ, Ropelewski
CF (2007) Validation of satellite rainfall products over East Africa's
complex topography. Int J Remote Sens 28:15031526
Estrela T, Vargas E (2012) Drought management plans in the European
Union. The case of Spain. Water Resour Manag 26:15371553
Farokhnia A, Morid S, Byun H-R (2011) Application of global SST and
SLP data for drought forecasting on Tehran plain using data mining
and ANFIS techniques. Theor Appl Climatol 104:7181
Heim RR (2002) A review of twentieth-century drought indices used in
the United States. Bull Am Meteorol Soc 83:11491165
Hosseini-Moghari SM, Araghinejad S (2015) Monthly and seasonal
drought forecasting using statistical neural networks. Environ
Earth Sci 74:397412
Huang S, Huang Q, Chang J, Leng G, Xing L (2015) The response of
agricultural drought to meteorological drought and the influencing
factors: a case study in the Wei River Basin, China. Agric Water
Manag 159:4554
Huang YF, Ang JT, Tiong YJ, Mirzaei M, Amin MZM (2016) Drought
forecasting using SPI and EDI under RCP-8.5 climate change scenarios for Langat River Basin, Malaysia. Procedia Eng 154:710717
Ionita M, Scholz P, Chelcea S (2016) Assessment of droughts in Romania
using the standardized precipitation index. Nat Hazards 81:1483
1498
Karakoc U, Patil S (2016) Comparison of TRMM satellite and groundbased precipitation data for predicting streamflow in Kucuk
Menderes River Basin, Turkey. In: EGU General Assembly
Conference Abstracts, p 1467

Page 15 of 16 132
Khashei M, Bijari M (2011) A novel hybridization of artificial neural
networks and ARIMA models for time series forecasting. Appl
Soft Comput 11:26642675
Le MH, Perez GC, Solomatine D, Nguyen LB (2016) Meteorological
drought forecasting based on climate signals using artificial neural
networka case study in Khanhhoa Province Vietnam. Procedia
Eng 154:11691175
Li X-H, Zhang Q, Xu C-Y (2012) Suitability of the TRMM satellite
rainfalls in driving a distributed hydrological model for water balance computations in Xinjiang catchment, Poyang Lake Basin. J
Hydrol 426427:2838
Li X, Zhang Q, Ye X (2013) Dry/wet conditions monitoring based on
TRMM rainfall data and its reliability validation over Poyang Lake
Basin, China. Water 5:18481864
Lohani VK, Loganathan GV, Mostaghimi S (1998) Long-term analysis
and short-term forecasting of dry spells by palmer drought severity
index. Hydrol Res 29:2140
Maca P, Pech P (2016) Forecasting SPEI and SPI drought indices using
the integrated artificial neural networks. Intell Neuroscience 2016:
1414
Mahfouz P, Mitri G, Jazi M, Karam F (2016) Investigating the temporal
variability of the standardized precipitation index in Lebanon.
Climate 4:27
McKee T, Doesken N, Kleist J (1993) The relation of drought frequency
and duration to time scales. In: Proceedings of the 8th Conference on
Applied Climatology, Anaheim, CA. American Meteorological
Society, Boston, MA, pp 179184
Meng J, Li L, Hao Z, Wang J, Shao Q (2014) Suitability of TRMM
satellite rainfall in driving a distributed hydrological model in the
source region of Yellow River. J Hydrol 509:320332
Mishra AK, Desai VR (2005) Drought forecasting using stochastic
models. Stoch Environ Res Ris Assess 19:326339
Mishra AK, Desai VR (2006) Drought forecasting using feed-forward
recursive neural network. Ecol Model 198:127138
Mishra A, Desai V, Singh V (2007) Drought forecasting using a hybrid
stochastic and neural network model. J Hydrol Eng 12:626638
Morid S, Smakhtin V, Bagherzadeh K (2007) Drought forecasting using
artificial neural networks and time series of drought indices. Int J
Climatol 27:21032111
Musuuza JL, Van Loon AF, Teuling AJ (2016) Multiscale evaluation of
the standardized precipitation index as a groundwater drought indicator. Hydrol Earth Syst Sci 20:1117
Nam W-H, Hayes MJ, Svoboda MD, Tadesse T, Wilhite DA (2015)
Drought hazard assessment in the context of climate change for
South Korea. Agric Water Manag 160:106117
Naumann G, Barbosa P, Carrao H, Singleton A, Vogt J (2012) Monitoring
drought conditions and their uncertainties in Africa using TRMM
data. J Appl Meteorol Climatol 51:18671874
Nicholson SE et al (2003) Validation of TRMM and other rainfall estimates with a high-density gauge dataset for West Africa. Part II:
validation of TRMM rainfall products. J Appl Meteorol 42:1355
1368
Oh K, Yu I, Kim H, Kim S, Kim L-h, Jeong S (2015) Drought assessment
based on real-time drought index. Desalin Water Treat 53:3111
3117
Olivares BO, Cortez A, Lobo D, Parra RM, Rey BJC, Rodrguez MF
(2016) Study of meteorological drought in the venezuelan plains
using the standardized precipitation index. Acta Nova 7:266
Qureshi AS, Akhtar M (2004) Analysis of drought-coping strategies in
Baluchistan and Sindh provinces of Pakistan. Sri Lanka,
International Water Management Institute, Working paper 86
Raudkivi AJ (2013) Hydrology: an advanced introduction to hydrological
processes and modelling. Elsevier Science, p 272
Ren W, Wang Y, Li J, Feng P, Smith RJ (2016) Drought forecasting in
Luanhe River basin involving climatic indices. Theor Appl Climatol
130:11331148

132

Page 16 of 16

Rezaeianzadeh M, Stein A, Cox JP (2017) Drought forecasting using
Markov chain model and artificial neural networks. Water Resour
Manag 30:22452259
Rhee J, Carbone GJ (2011) Estimating drought conditions for regions
with limited precipitation data. J Appl Meteorol Climatol 50:548
559
Sassa K, Canuti P, Yin Y (2014) Landslide science for a safer
geoenvironment. Volume 2: methods of landslide studies. Springer
International Publishing, p 302
Shafaei M, Kisi O (2016) Predicting river daily flow using waveletartificial neural networks based on regression analyses in comparison with artificial neural networks and support vector machine
models. Neural Comput Appl 28:1528
Simons G, Bastiaanssen W, Ng LA, Hain CR, Anderson M, Senay G
(2016) Integrating global satellite-derived data products as a preanalysis for hydrological modelling studies: a case study for the
Red River Basin. Remote Sens 8:279
Smakhtin VU, Hughes DA (2004) Review, automated estimation and
analyses of drought indices in South Asia. International Water
Management Institute, p 24
Soh YW, Koo CH, Huang YF, Fung KF (2018) Application of artificial
intelligence models for the prediction of standardized precipitation
evapotranspiration index (SPEI) at Langat River Basin, Malaysia.
Comput Electron Agric 144:164173
Strelcov K et al (2008) Bioclimatology and natural hazards. Springer,
Netherlands, p 87

Arab J Geosci (2018) 11:132
Su F, Hong Y, Lettenmaier DP (2008) Evaluation of TRMM
Multisatellite precipitation analysis (TMPA) and its utility in hydrologic prediction in the La Plata Basin. J Hydrometeorol 9:622640
Tang G, Zeng Z, Long D, Guo X, Yong B, Zhang W, Hong Y (2016)
Statistical and hydrological comparisons between TRMM and GPM
Level-3 products over a Midlatitude Basin: is day-1 IMERG a good
successor for TMPA 3B42V7? J Hydrometeorol 17:121137
Tao H, Fischer T, Zeng Y, Fraedrich K (2016) Evaluation of TRMM
3B43 precipitation data for drought monitoring in Jiangsu
Province, China. Water 8:221
Thom HCS (1958) A note on the gamma distribution. Mon Weather Rev
86:117122
Tian M, Wang P, Khan J (2016) Drought forecasting with vegetation
temperature condition index using ARIMA models in the
Guanzhong Plain. Remote Sens 8:690
Traore S, Luo Y, Fipps G (2016) Deployment of artificial neural network
for short-term forecasting of evapotranspiration using public weather forecast restricted messages. Agric Water Manag 163:363379
Valipour M (2016) Optimization of neural networks for precipitation
analysis in a humid region to detect drought and wet year alarms.
Meteorol Appl 23:91100
Zakhrouf M, Bouchelkia H, Stamboul M (2016) Neuro-Wavelet (WNN)
and Neuro-Fuzzy (ANFIS) systems for modeling hydrological time
series in arid areas. A case study: the catchment of An Hadjadj
(Algeria). Desalin Water Treat 57:1718217194
Zhang GP (2003) Time series forecasting using a hybrid ARIMA and
neural network model. Neurocomputing 50:159175

